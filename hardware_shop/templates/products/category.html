{% extends 'base.html' %}
{% load customtags %}
{% load thumbnail %}
{% block content %}
<div class="main-block">
    <p class="enter_text">{{ category.name }}</p>
</div>
<div class="main-block" name="list">
    <div>
        <form id="filter-price" class="filter-block" method="post" action="{% url 'products:category' category.id %}">
            {% csrf_token %}
            <div class="filter-block-inner">
                <div>
                    <p class="filter-text">Цена</p>
                </div>
                <div class="profile-info-row">
                    <div class="left-block">
                        <input type="number" class="filter-input" name="min_price" required placeholder="от 1 000"
                            value="{{min_price}}">
                    </div>
                    <div class="right-block">
                        <input type="number" class="filter-input" name="max_price" required placeholder="до 100 000"
                            value="{{max_price}}">
                    </div>
                </div>
            </div>
            <div class="filter-block-inner">
                <div>
                    <button id="set-filter" type="submit" class="button-signup" name="apply">
                        <p>Применить</p>
                    </button>
                    <button type="submit" class="button-reset" name="reset">
                        <p>Сбросить</p>
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div>
        <div class="icons-block">
            <a class="{% if now_sort == 'popular' %}active-filter{% else %}in-active-filter{% endif %}" name="popular"
                href="{% url 'products:sort' category.id 'popular' filter_link|default:'-' %}">
                <p>Популярные</p>
            </a>
            <a class="{% if now_sort == 'min_price' %}active-filter{% else %}in-active-filter{% endif %}"
                name="min_price" href="{% url 'products:sort' category.id 'min_price' filter_link|default:'-' %}">
                <p>Дешевле</p>
            </a>
            <a class="{% if now_sort == 'max_price' %}active-filter{% else %}in-active-filter{% endif %}"
                name="max_price" href="{% url 'products:sort' category.id 'max_price' filter_link|default:'-' %}">
                <p>Дороже</p>
            </a>
            <a class="{% if now_sort == 'alphabet' %}active-filter{% else %}in-active-filter{% endif %}" name="alphabet"
                href="{% url 'products:sort' category.id 'alphabet' filter_link|default:'-' %}">
                <p>По алфавиту</p>
            </a>
        </div>
        {% for row in page_obj %}
        <div class="row">
            {% for product in row %}
            <div class="card">
                <a class="image" href="{% url 'products:product' product.id %}">
                    {% thumbnail product.main_image "278x208" crop="center" upscale=True as product_image %}
                    <img src="{{ product_image.url }}" />
                    {% endthumbnail %}
                </a>
                <div class="card-down">
                    <div class="card-description">
                        <p class="popular-text">
                            {{ product.name }}
                        </p>
                        <p class="price">{{ product.price }} ₽</p>
                    </div>
                    <div class="in-cart">
                        {% include 'products/in-out_cart.html' %}
                        {% include 'products/in-out_favorite.html' %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
        {% include 'includes/paginator.html' %}
    </div>
</div>
{% endblock %}